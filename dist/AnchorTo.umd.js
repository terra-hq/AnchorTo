(function(s,r){typeof exports=="object"&&typeof module<"u"?module.exports=r():typeof define=="function"&&define.amd?define(r):(s=typeof globalThis<"u"?globalThis:s||self,s.AnchorTo=r())})(this,function(){"use strict";class s{constructor({trigger:t,destination:e,offset:i=0,url:n="hash",speed:h=1500,emitEvents:o=!0,popstate:a=!0,debug:l=!1,onComplete:d=null}){this.DOM={trigger:t,destination:e},this.offset=typeof i=="function"?i:()=>i,this.url=n,this.speed=h,this.emitEvents=o,this.popstate=a,this.debug=l,this.onComplete=d,this.init(),this.events(),this.debug&&console.log("AnchorTo Initialized:",{trigger:this.DOM.trigger,destination:this.DOM.destination,offset:this.offset(this.DOM.destination,this.DOM.trigger),url:this.url,speed:this.speed,emitEvents:this.emitEvents,popstate:this.popstate})}init(){}events(){this.DOM.trigger&&this.DOM.trigger.addEventListener("click",t=>this.handleClick(t)),this.popstate&&window.addEventListener("popstate",t=>this.handlePopstate(t))}handleClick(t){if(t.preventDefault(),this.scrollTo(this.DOM.destination),this.url!=="none"){const e=this.DOM.destination.id||"section";if(this.url==="hash")history.pushState(null,null,`#${e}`);else if(this.url==="query"){const i=new URLSearchParams(window.location.search);i.set("scrollto",e),history.pushState(null,null,`${window.location.pathname}?${i}`)}}this.emitEvents&&this.emitEvent("AnchorToStart")}handlePopstate(){const t=this.url==="query"?new URLSearchParams(window.location.search).get("scrollto"):window.location.hash.substring(1),e=document.getElementById(t);e&&this.scrollTo(e)}scrollTo(t){const e=window.pageYOffset,n=t.getBoundingClientRect().top+window.pageYOffset-this.offset(t,this.DOM.trigger)-e,h=this.speed;let o=null;const a=l=>{o||(o=l);const d=l-o,c=this.ease(d,e,n,h);window.scrollTo(0,c),d<h?requestAnimationFrame(a):(this.emitEvents&&this.emitEvent("AnchorToEnd"),typeof this.onComplete=="function"&&this.onComplete())};requestAnimationFrame(a)}ease(t,e,i,n){return t/=n/2,t<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)}emitEvent(t){const e=new CustomEvent(t,{detail:{element:this.DOM.trigger}});this.DOM.trigger.dispatchEvent(e)}destroy(){this.DOM.trigger&&this.DOM.trigger.removeEventListener("click",t=>this.handleClick(t)),this.popstate&&window.removeEventListener("popstate",t=>this.handlePopstate(t))}}return s});
